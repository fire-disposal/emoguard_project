<view class="container">
  <view wx:if="{{loading}}" class="loading">åŠ è½½ä¸­...</view>

  <view wx:else class="report-container">
    <!-- æŠ¥å‘Šæ ‡é¢˜ -->
    <view class="report-header">
      <text class="header-title">è®¤çŸ¥åŠŸèƒ½ç»¼åˆè¯„ä¼°æŠ¥å‘Š</text>
      <text class="header-date">{{group.completed_at}}</text>
    </view>

    <!-- æ€»ä½“ç»“è®º -->
    <view class="conclusion-section">
      <view class="section-title">
        <text class="title-icon">ğŸ“‹</text>
        <text>è¯„ä¼°ç»“è®º</text>
      </view>
      <view class="conclusion-card">
        <text class="conclusion-text">{{group.final_conclusion}}</text>
      </view>
    </view>

    <!-- é£é™©ç­‰çº§ -->
    <view class="risk-section" wx:if="{{comprehensiveAnalysis}}">
      <view class="section-title">
        <text class="title-icon">âš ï¸</text>
        <text>é£é™©ç­‰çº§</text>
      </view>
      <view class="risk-card risk-{{comprehensiveAnalysis.risk_level}}">
        <text class="risk-label">{{comprehensiveAnalysis.risk_level}}</text>
      </view>
    </view>

    <!-- è¯¦ç»†è¯´æ˜ -->
    <view class="summary-section" wx:if="{{comprehensiveAnalysis}}">
      <view class="section-title">
        <text class="title-icon">ğŸ“Š</text>
        <text>è¯„ä¼°è¯¦æƒ…</text>
      </view>
      <view class="summary-card">
        <text class="summary-text">{{comprehensiveAnalysis.summary}}</text>
      </view>
    </view>

    <!-- å„é‡è¡¨è¯¦æƒ… -->
    <view class="details-section" wx:if="{{comprehensiveAnalysis && comprehensiveAnalysis.details}}">
      <view class="section-title">
        <text class="title-icon">ğŸ“</text>
        <text>å„é‡è¡¨ç»“æœ</text>
      </view>
      
      <view wx:if="{{comprehensiveAnalysis.details.scd_q9}}" class="detail-card">
        <view class="detail-header">
          <text class="detail-name">SCD-Q9 ä¸»è§‚è®¤çŸ¥ä¸‹é™é‡è¡¨</text>
        </view>
        <view class="detail-score">
          <text class="score-label">å¾—åˆ†ï¼š</text>
          <text class="score-value">{{comprehensiveAnalysis.details.scd_q9.score}}</text>
          <text class="score-suffix">åˆ†</text>
        </view>
        <text class="detail-interp">{{comprehensiveAnalysis.details.scd_q9.interpretation}}</text>
      </view>

      <view wx:if="{{comprehensiveAnalysis.details.mmse}}" class="detail-card">
        <view class="detail-header">
          <text class="detail-name">MMSE ç®€æ˜“ç²¾ç¥çŠ¶æ€æ£€æŸ¥</text>
        </view>
        <view class="detail-score">
          <text class="score-label">å¾—åˆ†ï¼š</text>
          <text class="score-value">{{comprehensiveAnalysis.details.mmse.score}}</text>
          <text class="score-suffix">/ 30åˆ†</text>
        </view>
        <view class="detail-meta">
          <text>ç­‰çº§ï¼š{{comprehensiveAnalysis.details.mmse.level}}</text>
        </view>
        <text class="detail-interp">{{comprehensiveAnalysis.details.mmse.interpretation}}</text>
      </view>

      <view wx:if="{{comprehensiveAnalysis.details.moca}}" class="detail-card">
        <view class="detail-header">
          <text class="detail-name">MoCA è’™ç‰¹åˆ©å°”è®¤çŸ¥è¯„ä¼°</text>
        </view>
        <view class="detail-score">
          <text class="score-label">å¾—åˆ†ï¼š</text>
          <text class="score-value">{{comprehensiveAnalysis.details.moca.score}}</text>
          <text class="score-suffix">/ 30åˆ†</text>
        </view>
        <view wx:if="{{comprehensiveAnalysis.details.moca.education_bonus > 0}}" class="detail-meta">
          <text>ï¼ˆå«æ•™è‚²æ ¡æ­£ +{{comprehensiveAnalysis.details.moca.education_bonus}}åˆ†ï¼‰</text>
        </view>
        <text class="detail-interp">{{comprehensiveAnalysis.details.moca.interpretation}}</text>
      </view>
    </view>

    <!-- å»ºè®® -->
    <view class="recommendations-section" wx:if="{{comprehensiveAnalysis && comprehensiveAnalysis.recommendations}}">
      <view class="section-title">
        <text class="title-icon">ğŸ’¡</text>
        <text>ä¸“ä¸šå»ºè®®</text>
      </view>
      <view class="recommendations-list">
        <view 
          wx:for="{{comprehensiveAnalysis.recommendations}}" 
          wx:key="index"
          class="recommendation-item"
        >
          <text class="item-bullet">â€¢</text>
          <text class="item-text">{{item}}</text>
        </view>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="actions">
      <button class="btn-primary" bindtap="backToHome">è¿”å›é¦–é¡µ</button>
    </view>
  </view>
</view>
