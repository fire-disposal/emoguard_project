<!--pages/mood/record/record.wxml-->
<view class="mood-container gradient-bg">
  <!-- å¿ƒæƒ…è®°å½•æ¨¡å— -->
  <view class="mood-record-section card">
    <view class="section-header">
      <view class="header-left">
        <view class="section-icon">ğŸ’­</view>
        <text class="section-title">è®°å½•æ­¤åˆ»çš„å¿ƒæƒ…</text>
      </view>
    </view>

    <!-- å¿ƒæƒ…é€‰æ‹© -->
    <view class="mood-selector">
      <text class="selector-label">é€‰æ‹©å¿ƒæƒ…</text>
      <view class="mood-options">
        <view
          wx:for="{{moodOptions}}"
          wx:key="value"
          class="mood-option {{selectedMood === item.value ? 'selected' : ''}}"
          data-value="{{item.value}}"
          bindtap="selectMood"
        >
          <text class="mood-emoji">{{item.emoji}}</text>
          <text class="mood-label">{{item.label}}</text>
        </view>
      </view>
    </view>

    <!-- å¿ƒæƒ…åŸå› è¾“å…¥ -->
    <view class="mood-reason">
      <text class="reason-label">å¿ƒæƒ…åŸå› ï¼ˆé€‰å¡«ï¼‰</text>
      <textarea
        value="{{moodReason}}"
        class="reason-input"
        placeholder="åˆ†äº«ä¸€ä¸‹ç°åœ¨çš„æ„Ÿå—æˆ–å‘ç”Ÿäº†ä»€ä¹ˆ..."
        placeholder-class="reason-placeholder"
        maxlength="200"
        auto-height
        bindinput="onReasonInput"
      />
      <text class="reason-count">{{moodReason.length}}/200</text>
    </view>

    <!-- æäº¤æŒ‰é’® -->
    <view 
      class="submit-mood-btn {{selectedMood ? '' : 'btn-disabled'}}" 
      bindtap="submitMoodRecord"
    >
      <text class="btn-icon">âœ“</text>
      <text class="btn-text">è®°å½•å¿ƒæƒ…</text>
    </view>
  </view>

  <!-- å¿ƒæƒ…å†å² -->
  <view class="mood-history-section card">
    <view class="history-header">
      <text class="history-title">å¿ƒæƒ…å†å²</text>
      <text class="history-count">{{journals.length}}æ¡è®°å½•</text>
    </view>

    <view wx:if="{{loading}}" class="loading-state">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>

    <view wx:elif="{{journals.length === 0}}" class="empty-state">
      <text class="empty-icon">ğŸ’­</text>
      <text class="empty-text">è¿˜æ²¡æœ‰å¿ƒæƒ…è®°å½•</text>
      <text class="empty-hint">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®è®°å½•ä½ çš„ç¬¬ä¸€æ¡å¿ƒæƒ…å§</text>
    </view>

    <view wx:else class="history-list">
      <view 
        wx:for="{{journals}}" 
        wx:key="id" 
        class="history-item"
      >
        <view class="item-emoji">{{item.mood_emoji}}</view>
        <view class="item-content">
          <view class="item-header">
            <text class="item-mood-text">{{item.mood_name}}</text>
            <text class="item-time">{{formatTime(item.created_at)}}</text>
          </view>
          <text wx:if="{{item.text}}" class="item-reason">{{item.text}}</text>
          <text class="item-score">å¿ƒæƒ…åˆ†æ•°: {{item.mood_score}}/10</text>
        </view>
      </view>
    </view>
  </view>
</view>
